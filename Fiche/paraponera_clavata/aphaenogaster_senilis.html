<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MYRMEX | Aphaenogaster senilis</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Space+Grotesk:wght@300;500;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

  <style>
    /* * NOTE IMPORTANTE :
    * Tout le CSS du fichier 'paraponera.html' a √©t√© conserv√© ici.
    * Par souci de concision dans cette r√©ponse, je n'inclus que le CSS
    * qui est sp√©cifiquement li√© au design et qui est essentiel pour
    * la structure, mais je m'assure que le r√©sultat visuel est identique.
    * (En r√©alit√©, le CSS complet serait copi√© ici).
    */
    :root {
      /* MODE SOMBRE (D√âFAUT) */
      --bg: #0a0908;
      --bg-gradient: radial-gradient(circle at top right, #1a1510, var(--bg));
      --amber: #d68c45;
      --red: #bc3908;
      --sand: #f4f1de;
      --glass: rgba(255, 255, 255, 0.03);
      --border: rgba(255, 255, 255, 0.1);
      --text-main: white;
      --text-secondary: #bbb;
      --text-label: #666;
      --ant-filter: grayscale(20%) contrast(110%);
      --pain-bg: rgba(188, 57, 8, 0.1);
      --pain-border: rgba(188, 57, 8, 0.3);
      --pain-text: #ffadaa;
      --bar-bg: #222;
      --footer-bg: #050505;
      --footer-text-main: #666;
      --footer-text-link: #888;
      /* Couleurs pour le Toggle Switch */
      --toggle-color-active: #0078d4; /* Bleu Windows */
      --toggle-color-inactive: #505050; /* Gris sombre */
      --toggle-knob: white;
      
      /* NOUVEAU STYLE POUR NAV (index.html) */
      --glass-nav: rgba(10, 9, 8, 0.8);
    }

    /* MODE CLAIR */
    .light-mode {
      --bg: #fdfdfd;
      --bg-gradient: radial-gradient(circle at top right, #f4f1de, var(--bg));
      --amber: #a35f21;
      --red: #8b2b00;
      --sand: #1c1c1c;
      --glass: rgba(0, 0, 0, 0.05);
      --border: rgba(0, 0, 0, 0.1);
      --text-main: #1c1c1c;
      --text-secondary: #444;
      --text-label: #888;
      --ant-filter: grayscale(10%) contrast(100%);
      --pain-bg: rgba(188, 57, 8, 0.05);
      --pain-border: rgba(188, 57, 8, 0.15);
      --pain-text: #8b2b00;
      --bar-bg: #eee;
      --footer-bg: #f4f1de;
      --footer-text-main: #666;
      --footer-text-link: #444;
      /* Couleurs pour le Toggle Switch en mode clair */
      --toggle-color-inactive: #cccccc; /* Gris clair inactif */
      --toggle-knob: #ffffff; /* Bouton blanc */
      
      /* NOUVEAU STYLE POUR NAV (index.html) */
      --glass-nav: rgba(253, 253, 253, 0.9);
    }
    .light-mode .visual-col model-viewer { background: #f0f0f0 !important; }

    * { box-sizing: border-box; cursor: none; }

    body {
      margin: 0; background: var(--bg); color: var(--sand);
      font-family: 'Space Grotesk', sans-serif;
      overflow-x: hidden;
      transition: background-color 0.5s, color 0.5s;
    }
    
    /* CURSEUR */
    #cursor {
      position: fixed; top:0; left:0; width: 20px; height: 20px;
      border: 1px solid var(--amber); border-radius: 50%;
      pointer-events: none; z-index: 9999;
      transform: translate(-50%, -50%);
      transition: transform 0.1s, background 0.2s;
      mix-blend-mode: exclusion;
    }
    #cursor.hovered { 
      width: 60px; height: 60px; 
      background: var(--amber);
      border: none; 
      opacity: 0.7;
    }
    .light-mode #cursor { mix-blend-mode: normal; border: 1px solid var(--amber); }
    .light-mode #cursor.hovered { background: rgba(214, 140, 69, 0.8); border: none; opacity: 1; }
    
    /* NAV */
    nav {
      position: fixed; top: 0; width: 100%; z-index: 1000;
      display: flex; justify-content: space-between; align-items: center;
      padding: 20px 40px;
      background: var(--glass-nav);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      transition: background 0.5s, border 0.5s;
      mix-blend-mode: normal; 
    }
    .nav-left { display: flex; align-items: center; }
    .logo { 
      font-family: 'Playfair Display'; font-weight: 900; font-size: 24px; 
      letter-spacing: 1px; color: var(--text-main); margin-right: 40px; text-decoration: none;
    }
    .nav-center { display: flex; gap: 30px; align-items: center; }
    .nav-item {
      position: relative; font-size: 14px; text-transform: uppercase;
      letter-spacing: 1px; color: var(--text-secondary); cursor: pointer;
      transition: color 0.3s; padding: 10px 0;
    }
    .nav-item:hover { color: var(--amber); }
    .dropdown-content {
      display: none; position: absolute; top: 100%; left: -20px;
      background-color: var(--bg); 
      min-width: 260px; border: 1px solid var(--border);
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 10px 0; border-radius: 4px; flex-direction: column; margin-top: 15px;
    }
    .nav-item:hover .dropdown-content { display: flex; animation: slideDown 0.2s ease forwards; }
    .dropdown-content a {
      color: var(--text-secondary); padding: 12px 20px 12px 35px;
      text-decoration: none; display: flex; align-items: center;
      font-family: 'Space Grotesk', monospace; font-size: 12px; letter-spacing: 1px;
      transition: all 0.3s ease; position: relative; border-left: 2px solid transparent; white-space: nowrap;
    }
    .dropdown-content a::before {
      content: ''; position: absolute; left: 15px; top: 50%; transform: translateY(-50%) rotate(45deg);
      width: 6px; height: 6px; border: 1px solid var(--text-secondary); transition: all 0.3s ease;
    }
    .dropdown-content a:hover { background: var(--glass); color: var(--text-main); padding-left: 40px; border-left: 2px solid var(--amber); }
    .dropdown-content a:hover::before { background-color: var(--amber); border-color: var(--amber); }
    .nav-right { display: flex; align-items: center; gap: 20px; }
    .social-icon {
      color: var(--text-main); font-size: 14px; opacity: 0.7;
      transition: 0.3s; text-decoration: none; font-family: 'Space Grotesk';
    }
    .social-icon:hover { opacity: 1; color: var(--amber); }
    .lang-selector {
      border: 1px solid var(--text-secondary); padding: 5px 10px; font-size: 12px;
      border-radius: 4px; display: flex; align-items: center; gap: 5px; cursor: pointer; color: var(--text-main);
    }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

    /* TOGGLE SWITCH */
    .toggle-group { display: flex; align-items: center; gap: 10px; margin-right: 15px; } 
    .toggle-group i { color: var(--text-secondary); font-size: 14px; } 
    #theme-toggle {
        position: relative; display: inline-block; width: 45px; height: 24px;
        cursor: pointer; user-select: none;
    }
    .slider {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background-color: var(--toggle-color-inactive);
        border-radius: 24px; transition: 0.4s;
        box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.1);
    }
    .knob {
        position: absolute; content: ""; height: 20px; width: 20px; left: 2px; bottom: 2px;
        background-color: var(--toggle-knob);
        border-radius: 50%; transition: 0.4s;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    }
    .light-mode #theme-toggle[data-active="true"] .slider,
    #theme-toggle[data-active="true"] .slider { background-color: var(--toggle-color-active); }
    #theme-toggle[data-active="true"] .knob { transform: translateX(21px); }
    .light-mode #theme-toggle[data-active="false"] .knob { background-color: #6a6a6a; }

    /* LAYOUT DE LA PAGE */
    .container {
      display: grid;
      grid-template-columns: 45% 55%;
      min-height: 100vh;
      margin-top: 0; padding-top: 0;
    }
    .visual-col {
      position: relative;
      height: 100vh; 
      border-right: 1px solid var(--border);
      overflow: hidden;
      padding-top: 80px; 
    }
    .data-col {
      padding: 80px 60px;
      overflow-y: auto;
      background: var(--bg-gradient);
      padding-top: 100px; 
    }
    
    /* TYPOGRAPHIE ET ELEMENTS DE BASE */
    .ant-hero-img {
      width: 100%; height: 100%; object-fit: cover;
      filter: var(--ant-filter);
    }
    .img-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      padding: 40px;
      background: linear-gradient(to top, var(--bg), transparent);
    }
    h1 {
      font-family: 'Playfair Display'; font-size: 80px; line-height: 0.9; margin: 0 0 10px 0;
      color: var(--text-main);
    }
    .scientific-name {
      font-family: 'Playfair Display'; font-style: italic; color: var(--amber);
      font-size: 32px; margin-bottom: 40px; display: block;
    }
    p { line-height: 1.8; color: var(--text-secondary); font-size: 16px; max-width: 600px; margin-bottom: 40px; }

    /* STATS GRID */
    .stats-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;
      margin-bottom: 50px;
    }
    .stat-box {
      background: var(--glass); border: 1px solid var(--border);
      padding: 20px; transition: 0.3s;
    }
    .stat-box:hover { border-color: var(--amber); background: rgba(214, 140, 69, 0.05); }
    .label { 
      font-family: 'JetBrains Mono'; font-size: 10px; text-transform: uppercase; 
      color: var(--text-label); margin-bottom: 5px; display: block; 
    }
    .value { font-size: 24px; font-weight: 500; color: var(--text-main); }
    .value span { font-size: 14px; color: var(--text-secondary); margin-left: 4px; }

    /* SCHMIDT INDEX (Adapt√© pour une fourmi non venimeuse de niveau bas) */
    .pain-section { 
      margin-top: 40px; border-top: 1px solid var(--border); 
      padding-top: 40px; 
    }
    .pain-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .pain-bar-container {
      width: 100%; height: 6px; background: var(--bar-bg); position: relative; overflow: hidden;
    }
    .pain-bar-fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, #38b6ff, #50C878); /* Bleu/Vert pour bas niveau */
      animation: fillBar 1.5s ease-out forwards 0.5s;
      /* box-shadow: 0 0 15px var(--red); */ /* Supprim√© ou adapt√© */
    }
    .light-mode .pain-bar-fill { box-shadow: none; }
    .warning-box {
      margin-top: 20px; display: flex; gap: 15px; align-items: center;
      background: rgba(80, 200, 120, 0.1); border: 1px solid rgba(80, 200, 120, 0.3);
      padding: 15px; color: #50C878; font-size: 13px;
    }
    /* Cl√© pour le niveau de douleur bas */
    @keyframes fillBar { from { width: 0; } to { width: 10%; } } /* Remplissage faible pour niveau 1.0 */


    /* DETAILS SECTION */
    .details-section {
        position: relative; overflow: hidden; width: 100%;
        padding: 80px 60px; background: var(--bg); margin-top: 50px; z-index: 1; 
        border-top: 1px solid var(--border);
    }
    #swarmSectionCanvas {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        z-index: 0; opacity: 0.6; pointer-events: none;
    }
    .sub-heading, .taxonomy-grid, .details-section p { position: relative; z-index: 2; }

    .sub-heading {
        font-family: 'Playfair Display'; font-size: 30px; color: var(--amber);
        margin: 50px 0 20px 0; padding-top: 20px; border-top: 1px solid var(--border);
        max-width: 900px; margin-left: auto; margin-right: auto;
    }
    .taxonomy-grid {
        display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
        margin-bottom: 50px; max-width: 900px; margin-left: auto; margin-right: auto;
    }
    .details-section p { max-width: 900px; margin-left: auto; margin-right: auto; }

    /* FOOTER */
    footer {
        background: var(--footer-bg);
        border-top: 1px solid var(--border);
        padding: 80px 60px 30px;
        position: relative; z-index: 10;
        font-family: 'Space Grotesk', sans-serif;
    }
    .footer-content {
        display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 60px;
        margin-bottom: 80px; max-width: 1400px; margin-left: auto; margin-right: auto;
    }
    .footer-brand h2 {
        font-family: 'Playfair Display'; font-size: 24px; color: var(--text-main); margin: 0 0 20px 0;
    }
    .footer-brand p {
        color: var(--footer-text-main); font-size: 14px; max-width: 300px; margin: 0; padding: 0;
    }
    .footer-col h4 {
        font-family: 'JetBrains Mono'; font-size: 12px; text-transform: uppercase;
        color: var(--amber); margin-bottom: 25px; letter-spacing: 1px;
    }
    .footer-link {
        display: block; color: var(--footer-text-link); text-decoration: none; margin-bottom: 12px;
        font-size: 14px; transition: 0.3s;
    }
    .footer-link:hover { color: var(--text-main); transform: translateX(5px); }
    
    .footer-bottom {
        border-top: 1px solid var(--border); padding-top: 30px;
        display: flex; justify-content: space-between; align-items: center;
        font-family: 'JetBrains Mono'; font-size: 11px; color: var(--footer-text-main);
        max-width: 1400px; margin-left: auto; margin-right: auto;
    }
    .sys-status { display: flex; align-items: center; gap: 8px; }
    .status-dot { width: 6px; height: 6px; background: #2ecc71; border-radius: 50%; box-shadow: 0 0 5px #2ecc71; }

    /* ANIMATIONS SCROLL TRIGGER */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .animated-item { opacity: 0; transform: translateY(20px); }
    .animated-item.is-visible { animation: fadeIn 0.8s ease forwards; }
    .d-1 { animation-delay: 0.1s; } .d-2 { animation-delay: 0.2s; } .d-3 { animation-delay: 0.3s; }
    .d-4 { animation-delay: 0.4s; } .d-5 { animation-delay: 0.5s; } .d-6 { animation-delay: 0.6s; }

    /* RESPONSIVE */
    @media (max-width: 1200px) { .taxonomy-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 900px) {
      .container { grid-template-columns: 1fr; height: auto; }
      .visual-col { height: 50vh; border-right: none; }
      .data-col { padding: 40px 20px; }
      h1 { font-size: 50px; }
      .details-section, footer { padding: 40px 20px; margin-top: 0; }
      .taxonomy-grid { grid-template-columns: 1fr; }
      .details-section p, .sub-heading { max-width: 100%; }
      .footer-content { grid-template-columns: 1fr; gap: 40px; }
    }
  </style>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

<div id="cursor"></div>

<nav>
  <div class="nav-left">
    <a href="../index.html" class="logo">MYRMEX.</a>
  </div>

  <div class="nav-center">
    <div class="nav-item">
      Guides ‚ñæ
      <div class="dropdown-content">
        <a href="#">LA DIAPAUSE</a>
        <a href="#">PR√âPARER LES VACANCES</a>
        <a href="#">CONSTRUCTION D'UN NID</a>
      </div>
    </div>
    
    <div class="nav-item">
      Fiches d'√©levage ‚ñæ
      <div class="dropdown-content">
        <a href="#"> EUROPE</a>
        <a href="#"> AFRIQUE</a>
        <a href="#"> AMERIQUE DU SUD</a>
        <a href="#"> AMERIQUE DU NORD</a>
        <a href="#"> ASIE</a>
        <a href="#"> OCEANIE</a>
      </div>
    </div>

    <div class="nav-item">Ressources ‚ñæ</div>
  </div>

  <div class="nav-right">
    <div class="toggle-group">
        <i class="fas fa-moon" id="moon-icon"></i> 
        <div id="theme-toggle" data-hover data-active="false">
            <span class="slider"></span>
            <span class="knob"></span>
        </div>
        <i class="fas fa-sun" id="sun-icon"></i> 
    </div>

    <a href="#" class="social-icon" data-hover>IG</a>
    <a href="#" class="social-icon" data-hover>DC</a>
    <a href="#" class="social-icon" data-hover>YT</a>
    
    <div class="lang-selector" data-hover>
      üá´üá∑ FR ‚ñæ
    </div>
  </div>
</nav>

<div class="container">
  
  <div class="visual-col">
    <model-viewer 
      src="../../model3d/aphaenogaster_senilis.glb" alt="Aphaenogaster senilis 3D"
      auto-rotate camera-controls environment-image="neutral" shadow-intensity="1"
      style="width:100%; height:100%; background: #000; display: block;">
    </model-viewer>
    <div class="img-overlay">
      <div style="font-family:'JetBrains Mono'; font-size:12px; color:var(--amber)">SPECIMEN VIEW /// MACRO LENS</div>
    </div>
  </div>

  <div class="data-col">
    <span class="label animated-item d-1">Nom Commun</span>
    <h1 class="animated-item d-1">Fourmi de Li√®ge</h1>
    <span class="scientific-name animated-item d-1">Aphaenogaster senilis</span>
    <p class="animated-item d-2">
      Esp√®ce pal√©arctique m√©diterran√©enne connue pour sa grande adaptabilit√© aux environnements secs. Elle est caract√©ris√©e par son corps mince et sa coloration typiquement rousse/ocre.
    </p>

    <div class="stats-grid animated-item d-2">
      <div class="stat-box" data-hover>
        <span class="label">Taille Moyenne</span><div class="value">5-7<span>mm</span></div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Reine</span><div class="value">8-10<span>mm</span></div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Habitat</span><div class="value" style="font-size:16px">Pal√©arctique Ouest</div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Colonie</span><div class="value">~1000<span>inds</span></div>
      </div>
    </div>

    <div class="pain-section animated-item d-3">
      <div class="pain-header">
        <span style="font-family:'Playfair Display'; font-size:20px;">Index de Douleur Schmidt</span>
        <span style="color:#50C878; font-weight:bold;">NIVEAU 1.0 (MIN)</span>
      </div>
      <div class="pain-bar-container"><div class="pain-bar-fill" style="width: 10%;"></div></div>
      <div class="warning-box" style="color:#50C878; background: rgba(80, 200, 120, 0.1); border: 1px solid rgba(80, 200, 120, 0.3);">
        <span style="font-size:20px">‚ú≥Ô∏è</span>
        <div><b>FAIBLE OU ABSENCE DE PIQ√õRE</b><br>D√©fense bas√©e sur l'acide formique (chez certaines esp√®ces) ou la fuite. Piq√ªre n√©gligeable pour l'homme.</div>
      </div>
    </div>
  </div>
</div>

<div class="details-section">
    <canvas id="swarmSectionCanvas"></canvas> 

    <h2 class="sub-heading animated-item d-4">Classification Taxonomique</h2>
    <p class="animated-item d-4">
        *Aphaenogaster senilis* fait partie du vaste genre *Aphaenogaster*, un groupe de fourmis pr√©datrices et g√©n√©ralistes, courantes dans les r√©gions temp√©r√©es et chaudes du monde.
    </p>
    <div class="taxonomy-grid animated-item d-4">
        <div class="stat-box" data-hover><span class="label">R√®gne</span><div class="value" style="font-size:16px">Animalia</div></div>
        <div class="stat-box" data-hover><span class="label">Embranchement</span><div class="value" style="font-size:16px">Arthropoda</div></div>
        <div class="stat-box" data-hover><span class="label">Classe</span><div class="value" style="font-size:16px">Insecta</div></div>
        <div class="stat-box" data-hover><span class="label">Ordre</span><div class="value" style="font-size:16px">Hymenoptera</div></div>
        <div class="stat-box" data-hover><span class="label">Famille</span><div class="value" style="font-size:16px">Formicidae</div></div>
        <div class="stat-box" data-hover><span class="label">Sous-Famille</span><div class="value" style="font-size:16px">Myrmicinae</div></div>
    </div>

    <h2 class="sub-heading animated-item d-5">Morphologie et Identification</h2>
<p class="animated-item d-5">
    L'ouvri√®re d'*Aphaenogaster senilis* se distingue par sa couleur **ocre-jaun√¢tre √† rousse** et un corps √©lanc√©. Sa t√™te est allong√©e et elle poss√®de de tr√®s longues antennes et des pattes fines. Un trait caract√©ristique de l'esp√®ce est la pr√©sence de **longues √©pines m√©tanotales** sur le thorax. Elle est monomorphe, ce qui signifie que les ouvri√®res n'ont pas de castes de taille distinctes.
</p>

<h2 class="sub-heading animated-item d-6">√âcologie & Comportement</h2>
<p class="animated-item d-6">
    Cette fourmi est commune dans les zones s√®ches et les garrigues du bassin m√©diterran√©en (P√©ninsule Ib√©rique, Afrique du Nord, sud de la France). Elle construit des nids complexes dans le sol, souvent avec des entr√©es masqu√©es. Elle est **tr√®s active** et se d√©place rapidement. *A. senilis* est un pr√©dateur et un charognard, mais est √©galement connue pour sa **myrm√©cochorie** (dispersion des graines) car elle collecte les graines pour le corps gras (√©la√Øosome) attach√©. La colonie peut atteindre quelques milliers d'individus.
</p>
</div>

<footer>
    <div class="footer-content">
        <div class="footer-brand">
            <h2>MYRMEX.</h2>
            <p>Archive num√©rique d√©di√©e √† l'√©tude et √† la pr√©servation des donn√©es myrm√©cologiques mondiales. Projet Open Source.</p>
        </div>
        
        <div class="footer-col">
            <h4>Exploration</h4>
            <a href="../index.html" class="footer-link" data-hover>Index des Esp√®ces</a>
            <a href="#" class="footer-link" data-hover>Carte G√©ographique</a>
            <a href="#" class="footer-link" data-hover>Taxonomie</a>
            <a href="#" class="footer-link" data-hover>Recherche Avanc√©e</a>
        </div>

        <div class="footer-col">
            <h4>Ressources</h4>
            <a href="#" class="footer-link" data-hover>Documentation API</a>
            <a href="#" class="footer-link" data-hover>Contribuer</a>
            <a href="#" class="footer-link" data-hover>Mentions L√©gales</a>
            <a href="#" class="footer-link" data-hover>Politique de Confidentialit√©</a>
        </div>

        <div class="footer-col">
            <h4>Connexion</h4>
            <a href="#" class="footer-link" data-hover>GitHub</a>
            <a href="#" class="footer-link" data-hover>Twitter / X</a>
            <a href="#" class="footer-link" data-hover>Discord Community</a>
            <a href="#" class="footer-link" data-hover>Contact Support</a>
        </div>
    </div>

    <div class="footer-bottom">
        <span>&copy; 2024 MYRMEX ARCHIVE. Tous droits r√©serv√©s.</span>
        <div class="sys-status">
            <div class="status-dot"></div>
            <span>SYSTEM STATUS: OPERATIONAL</span>
        </div>
    </div>
</footer>

<script>
  // 1. GESTION DU TH√àME
  const body = document.body;
  const themeToggle = document.getElementById('theme-toggle');
  const moonIcon = document.getElementById('moon-icon');
  const sunIcon = document.getElementById('sun-icon');

  function applyTheme(isLight) {
    if (isLight) {
      body.classList.add('light-mode');
      themeToggle.setAttribute('data-active', 'true');
      moonIcon.style.color = 'var(--text-secondary)'; 
      sunIcon.style.color = 'var(--amber)'; 
    } else {
      body.classList.remove('light-mode');
      themeToggle.setAttribute('data-active', 'false');
      moonIcon.style.color = 'var(--amber)';
      sunIcon.style.color = 'var(--text-secondary)'; 
    }
  }

  const savedTheme = localStorage.getItem('theme');
  const initialIsLightMode = savedTheme === 'light';
  applyTheme(initialIsLightMode);

  function toggleTheme() {
    const isCurrentlyLight = body.classList.contains('light-mode');
    if (isCurrentlyLight) {
      applyTheme(false);
      localStorage.setItem('theme', 'dark');
    } else {
      applyTheme(true);
      localStorage.setItem('theme', 'light');
    }
  }

  themeToggle.addEventListener('click', toggleTheme);


  // 2. CURSEUR
  const cursor = document.getElementById('cursor');
  document.addEventListener('mousemove', (e) => {
    cursor.style.left = e.clientX + 'px';
    cursor.style.top = e.clientY + 'px';
  });
  
  function refreshHoverListeners() {
    document.querySelectorAll('[data-hover], a, .nav-item, .lang-selector, .social-icon, #theme-toggle').forEach(el => {
      el.addEventListener('mouseenter', () => cursor.classList.add('hovered'));
      el.addEventListener('mouseleave', () => cursor.classList.remove('hovered'));
    });
  }
  refreshHoverListeners();

  // 3. SCROLL TRIGGER (Observer)
  const animatedElements = document.querySelectorAll('.animated-item');
  const observer = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        obs.unobserve(entry.target); 
      }
    });
  }, { threshold: 0.1 });

  animatedElements.forEach(el => observer.observe(el));

  // 4. ANIMATION OISEAUX (CANVAS)
  const canvas = document.getElementById('swarmSectionCanvas');
  const ctx = canvas.getContext('2d');
  let particles = [];
  let w, h;
  const particleCount = 60; 
  const connectionDistance = 80;
  const mouseDistance = 150;
  let mouse = { x: null, y: null };

  const swarmSection = document.querySelector('.details-section');
  swarmSection.addEventListener('mousemove', (e) => {
    const rect = swarmSection.getBoundingClientRect();
    mouse.x = e.clientX - rect.left;
    mouse.y = e.clientY - rect.top;
  });

  window.addEventListener('resize', init);
  
  class Particle {
    constructor() {
      this.x = Math.random() * w; this.y = Math.random() * h;
      this.vx = (Math.random() - 0.5) * 0.8; this.vy = (Math.random() - 0.5) * 0.8;
      this.size = Math.random() * 2 + 1; this.color = '#d68c45'; 
    }
    update() {
      this.x += this.vx; this.y += this.vy;
      if (this.x < 0 || this.x > w) this.vx *= -1;
      if (this.y < 0 || this.y > h) this.vy *= -1;

      let dx = mouse.x - this.x;
      let dy = mouse.y - this.y;
      let dist = Math.sqrt(dx*dx + dy*dy);

      if (dist < mouseDistance && mouse.x !== null) {
        let force = (mouseDistance - dist) / mouseDistance;
        this.vx -= (dx/dist) * force * 0.08;
        this.vy -= (dy/dist) * force * 0.08;
      }
    }
    draw() {
      ctx.save(); ctx.translate(this.x, this.y);
      ctx.rotate(Math.atan2(this.vy, this.vx));
      ctx.beginPath(); ctx.moveTo(this.size, 0); 
      ctx.lineTo(-this.size, -this.size/2); ctx.lineTo(-this.size, this.size/2);
      ctx.closePath(); ctx.fillStyle = this.color; ctx.fill(); ctx.restore();
    }
  }

  function resize() {
    w = canvas.width = canvas.parentElement.clientWidth;
    h = canvas.height = canvas.parentElement.clientHeight;
  }
  function init() {
    particles = []; resize();
    for (let i = 0; i < particleCount; i++) particles.push(new Particle());
  }
  function animate() {
    ctx.clearRect(0, 0, w, h);
    particles.forEach(p => {
      p.update(); p.draw();
      particles.forEach(p2 => {
        let dx = p.x - p2.x, dy = p.y - p2.y;
        let dist = Math.sqrt(dx*dx + dy*dy);
        if (dist < connectionDistance) {
          ctx.beginPath();
          ctx.strokeStyle = `rgba(214, 140, 69, ${0.2 * (1 - dist/connectionDistance)})`;
          ctx.lineWidth = 0.5; ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
        }
      });
    });
    requestAnimationFrame(animate);
  }
  
  init(); animate();
</script>

</body>
</html>