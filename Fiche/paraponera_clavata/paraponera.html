<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MYRMEX | Paraponera clavata</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Space+Grotesk:wght@300;500;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

  <style>
    :root {
      /* MODE SOMBRE (DÉFAUT) */
      --bg: #0a0908;
      --bg-gradient: radial-gradient(circle at top right, #1a1510, var(--bg));
      --amber: #d68c45;
      --red: #bc3908;
      --sand: #f4f1de;
      --glass: rgba(255, 255, 255, 0.03);
      --border: rgba(255, 255, 255, 0.1);
      --text-main: white;
      --text-secondary: #bbb;
      --text-label: #666;
      --ant-filter: grayscale(20%) contrast(110%);
      --pain-bg: rgba(188, 57, 8, 0.1);
      --pain-border: rgba(188, 57, 8, 0.3);
      --pain-text: #ffadaa;
      --bar-bg: #222;
      --footer-bg: #050505;
      --footer-text-main: #666;
      --footer-text-link: #888;
      /* Couleurs pour le Toggle Switch */
      --toggle-color-active: #0078d4; /* Bleu Windows */
      --toggle-color-inactive: #505050; /* Gris sombre */
      --toggle-knob: white;
    }

    /* MODE CLAIR */
    .light-mode {
      --bg: #fdfdfd;
      --bg-gradient: radial-gradient(circle at top right, #f4f1de, var(--bg));
      --amber: #a35f21;
      --red: #8b2b00;
      --sand: #1c1c1c;
      --glass: rgba(0, 0, 0, 0.05);
      --border: rgba(0, 0, 0, 0.1);
      --text-main: #1c1c1c;
      --text-secondary: #444;
      --text-label: #888;
      --ant-filter: grayscale(10%) contrast(100%);
      --pain-bg: rgba(188, 57, 8, 0.05);
      --pain-border: rgba(188, 57, 8, 0.15);
      --pain-text: #8b2b00;
      --bar-bg: #eee;
      --footer-bg: #f4f1de;
      --footer-text-main: #666;
      --footer-text-link: #444;
      /* Couleurs pour le Toggle Switch en mode clair */
      --toggle-color-inactive: #cccccc; /* Gris clair inactif */
      --toggle-knob: #ffffff; /* Bouton blanc */
    }
    .light-mode .visual-col model-viewer { background: #f0f0f0 !important; }

    * { box-sizing: border-box; cursor: none; }

    body {
      margin: 0; background: var(--bg); color: var(--sand);
      font-family: 'Space Grotesk', sans-serif;
      overflow-x: hidden;
      transition: background-color 0.5s, color 0.5s;
    }

    /* --- CURSEUR --- */
    #cursor {
      position: fixed; top:0; left:0; width: 20px; height: 20px;
      border: 1px solid var(--amber); border-radius: 50%;
      pointer-events: none; z-index: 9999;
      transform: translate(-50%, -50%);
      transition: transform 0.1s, background 0.2s;
      mix-blend-mode: exclusion;
    }
    #cursor.hovered { 
      width: 60px; height: 60px; 
      background: var(--amber);
      border: none; 
      opacity: 0.7;
    }
    .light-mode #cursor { mix-blend-mode: normal; border: 1px solid var(--amber); }
    .light-mode #cursor.hovered { background: rgba(214, 140, 69, 0.8); border: none; opacity: 1; }

    /* --- NAVIGATION --- */
    .nav-bar {
      position: fixed; top: 0; width: 100%; z-index: 100;
      padding: 30px 50px; display: flex; justify-content: space-between;
      align-items: center;
      mix-blend-mode: exclusion;
    }
    .light-mode .nav-bar { mix-blend-mode: normal; }

    .nav-left, .nav-right { display: flex; align-items: center; gap: 20px; }

    .back-btn {
      text-decoration: none; color: var(--text-main); font-weight: 700;
      text-transform: uppercase; letter-spacing: 2px; display: flex; align-items: center; gap: 10px;
      font-size: 14px; transition: color 0.3s;
    }
    .back-btn:hover { color: var(--amber); }
    .id-tag { 
      font-family: 'JetBrains Mono'; 
      color: var(--amber); 
      border: 1px solid var(--amber); 
      padding: 4px 8px; 
      font-size: 12px;
    }

    /* === TOGGLE SWITCH STYLE === */
    .toggle-group { display: flex; align-items: center; gap: 10px; }
    .toggle-group i { color: var(--text-label); font-size: 18px; }

    #theme-toggle {
        position: relative;
        display: inline-block;
        width: 45px;
        height: 24px;
        cursor: pointer;
        user-select: none;
    }

    .slider {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: var(--toggle-color-inactive);
        border-radius: 24px;
        transition: 0.4s;
        box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.1);
    }

    .knob {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 2px;
        bottom: 2px;
        background-color: var(--toggle-knob);
        border-radius: 50%;
        transition: 0.4s;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    }
    .light-mode .knob { box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2); }

    /* État ACTIF (Mode Clair ou Sombre selon le contexte) */
    .light-mode #theme-toggle[data-active="true"] .slider {
        background-color: var(--toggle-color-active);
    }
    
    #theme-toggle[data-active="true"] .slider {
        background-color: var(--toggle-color-active);
    }

    #theme-toggle[data-active="true"] .knob {
        transform: translateX(21px);
    }

    /* État INACTIF (Mode Sombre ou Clair selon le contexte) */
    .light-mode #theme-toggle[data-active="false"] .knob {
        background-color: #6a6a6a; /* Bouton gris foncé pour l'inactif clair */
    }


    /* --- Le reste des styles (non modifié) --- */

    /* --- LAYOUT PRINCIPAL --- */
    .container {
      display: grid;
      grid-template-columns: 45% 55%;
      height: 100vh;
    }

    /* --- COLONNE GAUCHE --- */
    .visual-col {
      position: relative;
      height: 100%;
      border-right: 1px solid var(--border);
      overflow: hidden;
    }
    .ant-hero-img {
      width: 100%; height: 100%; object-fit: cover;
      filter: var(--ant-filter);
    }
    .img-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%;
      padding: 40px;
      background: linear-gradient(to top, var(--bg), transparent);
    }

    /* --- COLONNE DROITE --- */
    .data-col {
      padding: 80px 60px;
      overflow-y: auto;
      background: var(--bg-gradient);
    }

    h1 {
      font-family: 'Playfair Display'; font-size: 80px; line-height: 0.9; margin: 0 0 10px 0;
      color: var(--text-main);
    }
    .scientific-name {
      font-family: 'Playfair Display'; font-style: italic; color: var(--amber);
      font-size: 32px; margin-bottom: 40px; display: block;
    }
    
    p { line-height: 1.8; color: var(--text-secondary); font-size: 16px; max-width: 600px; margin-bottom: 40px; }

    /* STATS GRID */
    .stats-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;
      margin-bottom: 50px;
    }
    .stat-box {
      background: var(--glass); border: 1px solid var(--border);
      padding: 20px; transition: 0.3s;
    }
    .stat-box:hover { border-color: var(--amber); background: rgba(214, 140, 69, 0.05); }
    
    .label { 
      font-family: 'JetBrains Mono'; font-size: 10px; text-transform: uppercase; 
      color: var(--text-label); margin-bottom: 5px; display: block; 
    }
    .value { font-size: 24px; font-weight: 500; color: var(--text-main); }
    .value span { font-size: 14px; color: var(--text-secondary); margin-left: 4px; }

    /* SCHMIDT INDEX */
    .pain-section { 
      margin-top: 40px; border-top: 1px solid var(--border); 
      padding-top: 40px; 
    }
    .pain-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .pain-bar-container {
      width: 100%; height: 6px; background: var(--bar-bg); position: relative; overflow: hidden;
    }
    .pain-bar-fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--amber), var(--red));
      animation: fillBar 1.5s ease-out forwards 0.5s;
      box-shadow: 0 0 15px var(--red);
    }
    .warning-box {
      margin-top: 20px; display: flex; gap: 15px; align-items: center;
      background: var(--pain-bg); border: 1px solid var(--pain-border);
      padding: 15px; color: var(--pain-text); font-size: 13px;
    }
    .light-mode .pain-bar-fill { box-shadow: none; }

    /* === DETAILS SECTION === */
    .details-section {
        position: relative; overflow: hidden; width: 100%;
        padding: 80px 60px; background: var(--bg); margin-top: 50px; z-index: 1; 
        border-top: 1px solid var(--border);
    }
    #swarmSectionCanvas {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        z-index: 0; opacity: 0.6; pointer-events: none;
    }
    .sub-heading, .taxonomy-grid, .details-section p { position: relative; z-index: 2; }

    .sub-heading {
        font-family: 'Playfair Display'; font-size: 30px; color: var(--amber);
        margin: 50px 0 20px 0; padding-top: 20px; border-top: 1px solid var(--border);
        max-width: 900px; margin-left: auto; margin-right: auto;
    }
    .taxonomy-grid {
        display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
        margin-bottom: 50px; max-width: 900px; margin-left: auto; margin-right: auto;
    }
    .details-section p { max-width: 900px; margin-left: auto; margin-right: auto; }

    /* === FOOTER === */
    footer {
        background: var(--footer-bg);
        border-top: 1px solid var(--border);
        padding: 80px 60px 30px;
        position: relative; z-index: 10;
        font-family: 'Space Grotesk', sans-serif;
    }
    .footer-content {
        display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 60px;
        margin-bottom: 80px; max-width: 1400px; margin-left: auto; margin-right: auto;
    }
    .footer-brand h2 {
        font-family: 'Playfair Display'; font-size: 24px; color: var(--text-main); margin: 0 0 20px 0;
    }
    .footer-brand p {
        color: var(--footer-text-main); font-size: 14px; max-width: 300px; margin: 0; padding: 0;
    }
    .footer-col h4 {
        font-family: 'JetBrains Mono'; font-size: 12px; text-transform: uppercase;
        color: var(--amber); margin-bottom: 25px; letter-spacing: 1px;
    }
    .footer-link {
        display: block; color: var(--footer-text-link); text-decoration: none; margin-bottom: 12px;
        font-size: 14px; transition: 0.3s;
    }
    .footer-link:hover { color: var(--text-main); transform: translateX(5px); }
    
    .footer-bottom {
        border-top: 1px solid var(--border); padding-top: 30px;
        display: flex; justify-content: space-between; align-items: center;
        font-family: 'JetBrains Mono'; font-size: 11px; color: var(--footer-text-main);
        max-width: 1400px; margin-left: auto; margin-right: auto;
    }
    .sys-status { display: flex; align-items: center; gap: 8px; }
    .status-dot { width: 6px; height: 6px; background: #2ecc71; border-radius: 50%; box-shadow: 0 0 5px #2ecc71; }

    /* ANIMATIONS SCROLL TRIGGER */
    @keyframes fillBar { from { width: 0; } to { width: 100%; } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .animated-item { opacity: 0; transform: translateY(20px); }
    .animated-item.is-visible { animation: fadeIn 0.8s ease forwards; }
    .d-1 { animation-delay: 0.1s; } .d-2 { animation-delay: 0.2s; } .d-3 { animation-delay: 0.3s; }
    .d-4 { animation-delay: 0.4s; } .d-5 { animation-delay: 0.5s; } .d-6 { animation-delay: 0.6s; }

    /* RESPONSIVE */
    @media (max-width: 1200px) { .taxonomy-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 900px) {
      .container { grid-template-columns: 1fr; height: auto; }
      .visual-col { height: 50vh; border-right: none; }
      .data-col { padding: 40px 20px; }
      h1 { font-size: 50px; }
      .details-section, footer { padding: 40px 20px; margin-top: 0; }
      .taxonomy-grid { grid-template-columns: 1fr; }
      .details-section p, .sub-heading { max-width: 100%; }
      .footer-content { grid-template-columns: 1fr; gap: 40px; }
    }
  </style>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

<div id="cursor"></div>

<nav class="nav-bar">
  <div class="nav-left">
    <a href="../../index.html" class="back-btn" data-hover>← Retour Index</a>
  </div>
  <div class="nav-right">
    <div class="toggle-group">
        <i class="fas fa-moon" id="moon-icon"></i> <div id="theme-toggle" data-hover data-active="false">
            <span class="slider"></span>
            <span class="knob"></span>
        </div>
        <i class="fas fa-sun" id="sun-icon"></i> </div>
    <span class="id-tag">REF: PARA-001</span>
  </div>
</nav>

<div class="container">
  
  <div class="visual-col">
    <model-viewer 
      src="paraponera_clavata1.glb" alt="Paraponera clavata 3D"
      auto-rotate camera-controls environment-image="neutral" shadow-intensity="1"
      style="width:100%; height:100%; background: #000;">
    </model-viewer>
    <div class="img-overlay">
      <div style="font-family:'JetBrains Mono'; font-size:12px; color:var(--amber)">SPECIMEN VIEW /// MACRO LENS</div>
    </div>
  </div>

  <div class="data-col">
    <span class="label animated-item d-1">Nom Commun</span>
    <h1 class="animated-item d-1">BULLET ANT</h1>
    <span class="scientific-name animated-item d-1">Paraponera clavata</span>
    <p class="animated-item d-2">
      Connue pour posséder la piqûre la plus douloureuse du monde des insectes. La douleur est souvent comparée à celle d'un coup de fusil, persistant pendant 24 heures.
    </p>

    <div class="stats-grid animated-item d-2">
      <div class="stat-box" data-hover>
        <span class="label">Taille Moyenne</span><div class="value">25<span>mm</span></div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Reine</span><div class="value">30<span>mm</span></div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Habitat</span><div class="value" style="font-size:16px">Néotropique</div>
      </div>
      <div class="stat-box" data-hover>
        <span class="label">Colonie</span><div class="value">~2000<span>inds</span></div>
      </div>
    </div>

    <div class="pain-section animated-item d-3">
      <div class="pain-header">
        <span style="font-family:'Playfair Display'; font-size:20px;">Index de Douleur Schmidt</span>
        <span style="color:var(--red); font-weight:bold;">NIVEAU 4.0+ (MAX)</span>
      </div>
      <div class="pain-bar-container"><div class="pain-bar-fill"></div></div>
      <div class="warning-box">
        <span style="font-size:20px">⚠️</span>
        <div><b>TOXINE : PONERATOXINE</b><br>Neurotoxine bloquant la transmission synaptique.</div>
      </div>
    </div>
  </div>
</div>

<div class="details-section">
    <canvas id="swarmSectionCanvas"></canvas> 

    <h2 class="sub-heading animated-item d-4">Classification Taxonomique</h2>
    <p class="animated-item d-4">
        La *Paraponera clavata* est l'unique espèce au sein de son genre monotypique, *Paraponera*, ce qui souligne son statut évolutif unique au sein de la sous-famille des Paraponerinae.
    </p>
    <div class="taxonomy-grid animated-item d-4">
        <div class="stat-box" data-hover><span class="label">Règne</span><div class="value" style="font-size:16px">Animalia</div></div>
        <div class="stat-box" data-hover><span class="label">Embranchement</span><div class="value" style="font-size:16px">Arthropoda</div></div>
        <div class="stat-box" data-hover><span class="label">Classe</span><div class="value" style="font-size:16px">Insecta</div></div>
        <div class="stat-box" data-hover><span class="label">Ordre</span><div class="value" style="font-size:16px">Hymenoptera</div></div>
        <div class="stat-box" data-hover><span class="label">Famille</span><div class="value" style="font-size:16px">Formicidae</div></div>
        <div class="stat-box" data-hover><span class="label">Sous-Famille</span><div class="value" style="font-size:16px">Paraponerinae</div></div>
    </div>

    <h2 class="sub-heading animated-item d-5">Morphologie et Identification</h2>
<p class="animated-item d-5">
    L'ouvrière de *Paraponera clavata* est une fourmi de grande taille, mesurant jusqu'à 25 mm, ce qui en fait l'une des plus grandes espèces de fourmis. Elle possède un corps robuste, de couleur noir-rougeâtre foncé. Sa tête est rectangulaire, ses mandibules sont courtes et puissantes. Un trait distinctif est le pétiole armé d'une paire d'épines dorsales, et des sillons prononcés sur l'abdomen (gastrum).
</p>

<h2 class="sub-heading animated-item d-6">Écologie & Comportement</h2>
<p class="animated-item d-6">
    Originaire des forêts tropicales humides, la Bullet Ant se trouve du Nicaragua jusqu'au Paraguay. Elle est principalement terrestre et construit ses nids dans le sol, souvent à la base d'arbres ou sous des souches. La colonie est relativement petite pour une fourmi de cette taille, atteignant environ 2000 individus. Les ouvrières sont des chasseuses généralistes, se nourrissant d'arthropodes et de nectars végétaux. Elles sont célèbres pour les **colonnes de pillage** (raids) qu'elles forment pour ramener de grandes proies au nid.
</p>
</div>

<footer>
    <div class="footer-content">
        <div class="footer-brand">
            <h2>MYRMEX.</h2>
            <p>Archive numérique dédiée à l'étude et à la préservation des données myrmécologiques mondiales. Projet Open Source.</p>
        </div>
        
        <div class="footer-col">
            <h4>Exploration</h4>
            <a href="index.html" class="footer-link" data-hover>Index des Espèces</a>
            <a href="#" class="footer-link" data-hover>Carte Géographique</a>
            <a href="#" class="footer-link" data-hover>Taxonomie</a>
            <a href="#" class="footer-link" data-hover>Recherche Avancée</a>
        </div>

        <div class="footer-col">
            <h4>Ressources</h4>
            <a href="#" class="footer-link" data-hover>Documentation API</a>
            <a href="#" class="footer-link" data-hover>Contribuer</a>
            <a href="#" class="footer-link" data-hover>Mentions Légales</a>
            <a href="#" class="footer-link" data-hover>Politique de Confidentialité</a>
        </div>

        <div class="footer-col">
            <h4>Connexion</h4>
            <a href="#" class="footer-link" data-hover>GitHub</a>
            <a href="#" class="footer-link" data-hover>Twitter / X</a>
            <a href="#" class="footer-link" data-hover>Discord Community</a>
            <a href="#" class="footer-link" data-hover>Contact Support</a>
        </div>
    </div>

    <div class="footer-bottom">
        <span>&copy; 2024 MYRMEX ARCHIVE. Tous droits réservés.</span>
        <div class="sys-status">
            <div class="status-dot"></div>
            <span>SYSTEM STATUS: OPERATIONAL</span>
        </div>
    </div>
</footer>

<script>
  // 1. GESTION DU THÈME
  const body = document.body;
  const themeToggle = document.getElementById('theme-toggle');
  const moonIcon = document.getElementById('moon-icon');
  const sunIcon = document.getElementById('sun-icon');

  // Fonction pour appliquer le thème
  function applyTheme(isLight) {
    if (isLight) {
      body.classList.add('light-mode');
      themeToggle.setAttribute('data-active', 'true');
      moonIcon.style.color = 'var(--text-label)'; 
      sunIcon.style.color = 'var(--amber)'; 
    } else {
      body.classList.remove('light-mode');
      themeToggle.setAttribute('data-active', 'false');
      moonIcon.style.color = 'var(--amber)';
      sunIcon.style.color = 'var(--text-label)';
    }
  }

  // Charger le thème depuis localStorage ou utiliser le mode sombre par défaut
  const savedTheme = localStorage.getItem('theme');
  const initialIsLightMode = savedTheme === 'light';
  applyTheme(initialIsLightMode);


  // Fonction de bascule
  function toggleTheme() {
    const isCurrentlyLight = body.classList.contains('light-mode');
    if (isCurrentlyLight) {
      applyTheme(false);
      localStorage.setItem('theme', 'dark');
    } else {
      applyTheme(true);
      localStorage.setItem('theme', 'light');
    }
  }

  // Événement sur le bouton
  themeToggle.addEventListener('click', toggleTheme);


  // 2. CURSEUR
  const cursor = document.getElementById('cursor');
  document.addEventListener('mousemove', (e) => {
    cursor.style.left = e.clientX + 'px';
    cursor.style.top = e.clientY + 'px';
  });
  
  function refreshHoverListeners() {
    document.querySelectorAll('[data-hover], a, #theme-toggle').forEach(el => { /* Cible le nouveau toggle */
      el.addEventListener('mouseenter', () => cursor.classList.add('hovered'));
      el.addEventListener('mouseleave', () => cursor.classList.remove('hovered'));
    });
  }
  refreshHoverListeners();

  // 3. SCROLL TRIGGER (Observer)
  const animatedElements = document.querySelectorAll('.animated-item');
  const observer = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        obs.unobserve(entry.target); 
      }
    });
  }, { threshold: 0.1 });

  animatedElements.forEach(el => observer.observe(el));

  // 4. ANIMATION OISEAUX (CANVAS)
  const canvas = document.getElementById('swarmSectionCanvas');
  const ctx = canvas.getContext('2d');
  let particles = [];
  let w, h;
  const particleCount = 60; 
  const connectionDistance = 80;
  const mouseDistance = 150;
  let mouse = { x: null, y: null };

  window.addEventListener('mousemove', (e) => { mouse.x = e.x; mouse.y = e.y; });
  window.addEventListener('resize', init);
  
  class Particle {
    constructor() {
      this.x = Math.random() * w; this.y = Math.random() * h;
      this.vx = (Math.random() - 0.5) * 0.8; this.vy = (Math.random() - 0.5) * 0.8;
      this.size = Math.random() * 2 + 1; this.color = '#d68c45'; 
    }
    update() {
      this.x += this.vx; this.y += this.vy;
      if (this.x < 0 || this.x > w) this.vx *= -1;
      if (this.y < 0 || this.y > h) this.vy *= -1;

      const rect = canvas.getBoundingClientRect();
      let dx = (mouse.x - rect.left) - this.x;
      let dy = (mouse.y - rect.top) - this.y;
      let dist = Math.sqrt(dx*dx + dy*dy);

      if (dist < mouseDistance) {
        let force = (mouseDistance - dist) / mouseDistance;
        this.vx -= (dx/dist) * force * 0.08;
        this.vy -= (dy/dist) * force * 0.08;
      }
    }
    draw() {
      ctx.save(); ctx.translate(this.x, this.y);
      ctx.rotate(Math.atan2(this.vy, this.vx));
      ctx.beginPath(); ctx.moveTo(this.size, 0); 
      ctx.lineTo(-this.size, -this.size/2); ctx.lineTo(-this.size, this.size/2);
      ctx.closePath(); ctx.fillStyle = this.color; ctx.fill(); ctx.restore();
    }
  }

  function resize() {
    w = canvas.width = canvas.parentElement.clientWidth;
    h = canvas.height = canvas.parentElement.clientHeight;
  }
  function init() {
    particles = []; resize();
    for (let i = 0; i < particleCount; i++) particles.push(new Particle());
  }
  function animate() {
    ctx.clearRect(0, 0, w, h);
    particles.forEach(p => {
      p.update(); p.draw();
      particles.forEach(p2 => {
        let dx = p.x - p2.x, dy = p.y - p2.y;
        let dist = Math.sqrt(dx*dx + dy*dy);
        if (dist < connectionDistance) {
          ctx.beginPath();
          /* La couleur de la ligne utilise toujours l'opacité sur l'ambre par défaut */
          ctx.strokeStyle = `rgba(214, 140, 69, ${0.2 * (1 - dist/connectionDistance)})`;
          ctx.lineWidth = 0.5; ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
        }
      });
    });
    requestAnimationFrame(animate);
  }
  
  init(); animate();
</script>

</body>
</html>